<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/ecommerce/src/main/java/dev/trier/ecommerce/dto/feedback/FeedbackListResponseDto.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/ecommerce/src/main/java/dev/trier/ecommerce/dto/feedback/FeedbackListResponseDto.java" />
              <option name="originalContent" value="package dev.trier.ecommerce.dto.feedback;&#10;&#10;import lombok.AllArgsConstructor;&#10;import lombok.Data;&#10;import lombok.NoArgsConstructor;&#10;&#10;import java.time.LocalDate;&#10;&#10;@Data&#10;@AllArgsConstructor&#10;@NoArgsConstructor&#10;public class FeedbackListResponseDto {&#10;&#10;    private Integer cdFeedback;&#10;    private Integer nuAvaliacao;&#10;    private String dsComentario;&#10;    private String nmCliente;&#10;    private String nmProduto;&#10;    private LocalDate dtCriacao;&#10;}&#10;" />
              <option name="updatedContent" value="package dev.trier.ecommerce.dto.feedback;&#10;&#10;import java.time.LocalDate;&#10;&#10;public record FeedbackListResponseDto(&#10;        Integer cdFeedback,&#10;        Integer nuAvaliacao,&#10;        String dsComentario,&#10;        String nmCliente,&#10;        String nmProduto,&#10;        LocalDate dtCriacao&#10;) {}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/ecommerce/src/main/java/dev/trier/ecommerce/dto/produto/request/UpdateRequestDto.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/ecommerce/src/main/java/dev/trier/ecommerce/dto/produto/request/UpdateRequestDto.java" />
              <option name="originalContent" value="package dev.trier.ecommerce.dto.produto.request;&#10;&#10;&#10;import lombok.AllArgsConstructor;&#10;import lombok.Data;&#10;import lombok.NoArgsConstructor;&#10;&#10;@Data&#10;@AllArgsConstructor&#10;@NoArgsConstructor&#10;public class UpdateRequestDto {&#10;    private String nmProduto;&#10;    private Double vlProduto;&#10;    private String dsProduto;&#10;    private String dsCategoria;&#10;    private Integer cdEmpresa;&#10;&#10;&#10;&#10;&#10;}&#10;" />
              <option name="updatedContent" value="package dev.trier.ecommerce.dto.produto.request;&#13;&#10;&#13;&#10;public record UpdateRequestDto(&#13;&#10;        String nmProduto,&#13;&#10;        Double vlProduto,&#13;&#10;        String dsProduto,&#13;&#10;        String dsCategoria,&#13;&#10;        Integer cdEmpresa&#13;&#10;) {}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/ecommerce/src/main/java/dev/trier/ecommerce/service/ItemCarrinhoService.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/ecommerce/src/main/java/dev/trier/ecommerce/service/ItemCarrinhoService.java" />
              <option name="originalContent" value="package dev.trier.ecommerce.service;&#10;&#10;import dev.trier.ecommerce.dto.ItemCarrinho.criacao.ItemCarrinhoCriarDto;&#10;import dev.trier.ecommerce.dto.ItemCarrinho.modificacao.ItemCarrinhoUpdateDto;&#10;import dev.trier.ecommerce.dto.ItemCarrinho.response.ItemCarrinhoCriadoResponseDto;&#10;import dev.trier.ecommerce.exceptions.RecursoNaoEncontradoException;&#10;import dev.trier.ecommerce.model.ProdutoModel;&#10;import dev.trier.ecommerce.model.carrinho.CarrinhoModel;&#10;import dev.trier.ecommerce.model.carrinho.ItemCarrinhoModel;&#10;import dev.trier.ecommerce.repository.ProdutoRepository;&#10;import dev.trier.ecommerce.repository.carrinho.CarrinhoRepository;&#10;import dev.trier.ecommerce.repository.carrinho.ItemCarrinhoRepository;&#10;import lombok.AllArgsConstructor;&#10;import org.springframework.stereotype.Service;&#10;import org.springframework.transaction.annotation.Transactional;&#10;&#10;import java.util.Optional;&#10;&#10;@Service&#10;@AllArgsConstructor&#10;public class ItemCarrinhoService {&#10;&#10;    private final ItemCarrinhoRepository itemCarrinhoRepository;&#10;    private final CarrinhoRepository carrinhoRepository;&#10;    private final ProdutoRepository produtoRepository;&#10;&#10;    @Transactional&#10;    public ItemCarrinhoCriadoResponseDto adicionarItemAoCarrinho(Integer cdCarrinho, ItemCarrinhoCriarDto itemCriarDto) {&#10;&#10;        CarrinhoModel carrinhoModel = carrinhoRepository.findById(cdCarrinho)&#10;                .orElseThrow(() -&gt; new RecursoNaoEncontradoException(&quot;Carrinho não encontrado: &quot; + cdCarrinho));&#10;&#10;        ProdutoModel produtoModel = produtoRepository.findById(itemCriarDto.cdProduto())&#10;                .orElseThrow(() -&gt; new RecursoNaoEncontradoException(&quot;Produto não encontrado: &quot; + itemCriarDto.cdProduto()));&#10;&#10;        Optional&lt;ItemCarrinhoModel&gt; itemExistenteOptional = itemCarrinhoRepository.findByCarrinho_CdCarrinhoAndProduto_CdProduto(&#10;                cdCarrinho, itemCriarDto.cdProduto());&#10;&#10;        ItemCarrinhoModel itemSalvo;&#10;&#10;        if (itemExistenteOptional.isPresent()) {&#10;            ItemCarrinhoModel itemExistente = itemExistenteOptional.get();&#10;            itemExistente.setQtdItemCarrinho(itemExistente.getQtdItemCarrinho() + itemCriarDto.qtdItemCarrinho());&#10;            itemSalvo = itemCarrinhoRepository.save(itemExistente);&#10;        } else {&#10;            ItemCarrinhoModel novoItem = new ItemCarrinhoModel();&#10;            novoItem.setCarrinho(carrinhoModel);&#10;            novoItem.setProduto(produtoModel);&#10;            novoItem.setQtdItemCarrinho(itemCriarDto.qtdItemCarrinho());&#10;            itemSalvo = itemCarrinhoRepository.save(novoItem);&#10;        }&#10;&#10;        return new ItemCarrinhoCriadoResponseDto(&#10;                itemSalvo.getCdItensCarrinho(),&#10;                itemSalvo.getCarrinho().getCdCarrinho(),&#10;                itemSalvo.getProduto().getCdProduto(),&#10;                itemSalvo.getProduto().getNmProduto(),&#10;                itemSalvo.getQtdItemCarrinho()&#10;        );&#10;    }&#10;&#10;    @Transactional&#10;    public ItemCarrinhoCriadoResponseDto atualizarItemCarrinho(Integer cdItemCarrinho, ItemCarrinhoUpdateDto updateDto) {&#10;&#10;        ItemCarrinhoModel itemModel = itemCarrinhoRepository.findById(cdItemCarrinho)&#10;                .orElseThrow(() -&gt; new RecursoNaoEncontradoException(&quot;Item do Carrinho não encontrado: &quot; + cdItemCarrinho));&#10;&#10;        if (updateDto.qtdItemCarrinho() != null) {&#10;            itemModel.setQtdItemCarrinho(updateDto.qtdItemCarrinho());&#10;        }&#10;&#10;        ItemCarrinhoModel itemSalvo = itemCarrinhoRepository.save(itemModel);&#10;&#10;        return new ItemCarrinhoCriadoResponseDto(&#10;                itemSalvo.getCdItensCarrinho(),&#10;                itemSalvo.getCarrinho().getCdCarrinho(),&#10;                itemSalvo.getProduto().getCdProduto(),&#10;                itemSalvo.getProduto().getNmProduto(),&#10;                itemSalvo.getQtdItemCarrinho()&#10;        );&#10;    }&#10;&#10;    @Transactional&#10;    public void removerItemDoCarrinho(Integer cdCarrinho, Integer cdItemCarrinho) {&#10;        ItemCarrinhoModel itemModel = itemCarrinhoRepository.findById(cdItemCarrinho)&#10;                .orElseThrow(() -&gt; new RecursoNaoEncontradoException(&quot;Item do carrinho não encontrado: &quot; + cdItemCarrinho));&#10;&#10;        if (itemModel.getCarrinho() == null || !itemModel.getCarrinho().getCdCarrinho().equals(cdCarrinho)) {&#10;            throw new RecursoNaoEncontradoException(&quot;Item do carrinho não pertence ao carrinho informado&quot;);&#10;        }&#10;&#10;        itemCarrinhoRepository.delete(itemModel);&#10;    }&#10;}" />
              <option name="updatedContent" value="package dev.trier.ecommerce.service;&#13;&#10;&#13;&#10;import dev.trier.ecommerce.dto.ItemCarrinho.criacao.ItemCarrinhoCriarDto;&#13;&#10;import dev.trier.ecommerce.dto.ItemCarrinho.modificacao.ItemCarrinhoUpdateDto;&#13;&#10;import dev.trier.ecommerce.dto.ItemCarrinho.response.ItemCarrinhoCriadoResponseDto;&#13;&#10;import dev.trier.ecommerce.exceptions.RecursoNaoEncontradoException;&#13;&#10;import dev.trier.ecommerce.model.ProdutoModel;&#13;&#10;import dev.trier.ecommerce.model.carrinho.CarrinhoModel;&#13;&#10;import dev.trier.ecommerce.model.carrinho.ItemCarrinhoModel;&#13;&#10;import dev.trier.ecommerce.repository.ProdutoRepository;&#13;&#10;import dev.trier.ecommerce.repository.carrinho.CarrinhoRepository;&#13;&#10;import dev.trier.ecommerce.repository.carrinho.ItemCarrinhoRepository;&#13;&#10;import lombok.AllArgsConstructor;&#13;&#10;import org.springframework.stereotype.Service;&#13;&#10;import org.springframework.transaction.annotation.Transactional;&#13;&#10;&#13;&#10;import java.util.Optional;&#13;&#10;&#13;&#10;@Service&#13;&#10;@AllArgsConstructor&#13;&#10;public class ItemCarrinhoService {&#13;&#10;&#13;&#10;    private final ItemCarrinhoRepository itemCarrinhoRepository;&#13;&#10;    private final CarrinhoRepository carrinhoRepository;&#13;&#10;    private final ProdutoRepository produtoRepository;&#13;&#10;&#13;&#10;    @Transactional&#13;&#10;    public ItemCarrinhoCriadoResponseDto adicionarItemAoCarrinho(Integer cdCarrinho, ItemCarrinhoCriarDto itemCriarDto) {&#13;&#10;&#13;&#10;        CarrinhoModel carrinhoModel = carrinhoRepository.findById(cdCarrinho)&#13;&#10;                .orElseThrow(() -&gt; new RecursoNaoEncontradoException(&quot;Carrinho não encontrado: &quot; + cdCarrinho));&#13;&#10;&#13;&#10;        ProdutoModel produtoModel = produtoRepository.findById(itemCriarDto.cdProduto())&#13;&#10;                .orElseThrow(() -&gt; new RecursoNaoEncontradoException(&quot;Produto não encontrado: &quot; + itemCriarDto.cdProduto()));&#13;&#10;&#13;&#10;        Optional&lt;ItemCarrinhoModel&gt; itemExistenteOptional = itemCarrinhoRepository.findByCarrinho_CdCarrinhoAndProduto_CdProduto(&#13;&#10;                cdCarrinho, itemCriarDto.cdProduto());&#13;&#10;&#13;&#10;        ItemCarrinhoModel itemSalvo;&#13;&#10;&#13;&#10;        if (itemExistenteOptional.isPresent()) {&#13;&#10;            ItemCarrinhoModel itemExistente = itemExistenteOptional.get();&#13;&#10;            itemExistente.setQtdItemCarrinho(itemExistente.getQtdItemCarrinho() + itemCriarDto.qtdItemCarrinho());&#13;&#10;            itemSalvo = itemCarrinhoRepository.save(itemExistente);&#13;&#10;        } else {&#13;&#10;            ItemCarrinhoModel novoItem = new ItemCarrinhoModel();&#13;&#10;            novoItem.setCarrinho(carrinhoModel);&#13;&#10;            novoItem.setProduto(produtoModel);&#13;&#10;            novoItem.setQtdItemCarrinho(itemCriarDto.qtdItemCarrinho());&#13;&#10;            itemSalvo = itemCarrinhoRepository.save(novoItem);&#13;&#10;        }&#13;&#10;&#13;&#10;        return new ItemCarrinhoCriadoResponseDto(&#13;&#10;                itemSalvo.getCdItensCarrinho(),&#13;&#10;                itemSalvo.getCarrinho().getCdCarrinho(),&#13;&#10;                itemSalvo.getProduto().getCdProduto(),&#13;&#10;                itemSalvo.getProduto().getNmProduto(),&#13;&#10;                itemSalvo.getQtdItemCarrinho()&#13;&#10;        );&#13;&#10;    }&#13;&#10;&#13;&#10;    @Transactional&#13;&#10;    public ItemCarrinhoCriadoResponseDto atualizarItemCarrinho(Integer cdItemCarrinho, ItemCarrinhoUpdateDto updateDto) {&#13;&#10;&#13;&#10;        ItemCarrinhoModel itemModel = itemCarrinhoRepository.findById(cdItemCarrinho)&#13;&#10;                .orElseThrow(() -&gt; new RecursoNaoEncontradoException(&quot;Item do Carrinho não encontrado: &quot; + cdItemCarrinho));&#13;&#10;&#13;&#10;        if (updateDto.qtdItemCarrinho() != null) {&#13;&#10;            itemModel.setQtdItemCarrinho(updateDto.qtdItemCarrinho());&#13;&#10;        }&#13;&#10;&#13;&#10;        ItemCarrinhoModel itemSalvo = itemCarrinhoRepository.save(itemModel);&#13;&#10;&#13;&#10;        return new ItemCarrinhoCriadoResponseDto(&#13;&#10;                itemSalvo.getCdItensCarrinho(),&#13;&#10;                itemSalvo.getCarrinho().getCdCarrinho(),&#13;&#10;                itemSalvo.getProduto().getCdProduto(),&#13;&#10;                itemSalvo.getProduto().getNmProduto(),&#13;&#10;                itemSalvo.getQtdItemCarrinho()&#13;&#10;        );&#13;&#10;    }&#13;&#10;&#13;&#10;    @Transactional&#13;&#10;    public void removerItemDoCarrinho(Integer cdCarrinho, Integer cdItemCarrinho) {&#13;&#10;        ItemCarrinhoModel itemModel = itemCarrinhoRepository.findById(cdItemCarrinho)&#13;&#10;                .orElseThrow(() -&gt; new RecursoNaoEncontradoException(&quot;Item do carrinho não encontrado: &quot; + cdItemCarrinho));&#13;&#10;&#13;&#10;        if (itemModel.getCarrinho() == null || !itemModel.getCarrinho().getCdCarrinho().equals(cdCarrinho)) {&#13;&#10;            throw new RecursoNaoEncontradoException(&quot;Item do carrinho não pertence ao carrinho informado&quot;);&#13;&#10;        }&#13;&#10;&#13;&#10;        itemCarrinhoRepository.delete(itemModel);&#13;&#10;    }&#13;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>